"0","df_v2 %>% mutate(weekday = wday(df_v2$start_time, label = TRUE )) %>% "
"0","  filter(between(date, as.Date('2019-06-30'), as.Date('2019-07-06'))) %>% group_by(usertype, date) %>% "
"0","  summarise(total = n()) %>% mutate(Percentage = round(total/sum(total)*100,1)) %>% "
"0","  ggplot(mapping = aes(x= date, y= total, fill = usertype)) +"
"0","  geom_col(position = ""dodge"") + labs(x = ""Day of the Week"", "
"0","  y = ""Total rides per user type"", "
"0","  title= ""Total rides per weekday and per user type, 30 Jun to 6 Jul 2019"", "
"0","  subtitle= ""Week of Independence Day (Thursday)"") + "
"0","  geom_text(aes(label= total), vjust=1.5, size = 3,  "
"0","            position = position_dodge(width = 0.9)) +"
"0","  scale_x_date(sec.axis = sec_axis(~., name = ""Weekday""),date_breaks = ""1 day"", "
"0","  date_labels = ""%A"" )+"
"0","  annotate(geom = ""segment"", x = as.Date('2019-07-05'), y = 11000, "
"0","           xend = as.Date('2019-07-04'), yend = 9374)+"
"0","  annotate(geom = ""Text"", x = as.Date('2019-07-06'), y = 12000, label = ""Independence Day"", hjust = ""right"")"
"2","`summarise()` has grouped output by 'usertype'. You can override using the `.groups` argument."
